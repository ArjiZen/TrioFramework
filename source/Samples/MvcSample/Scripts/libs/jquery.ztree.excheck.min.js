!function(e){var t,n,a,o={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},i={check:{enable:!1,autoCheckTrigger:!1,chkStyle:o.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:o.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}};t=function(e,t){if(t.chkDisabled===!0)return!1;var n=d.getSetting(e.data.treeId),a=n.data.key.checked;return 0==r.apply(n.callback.beforeCheck,[n.treeId,t],!0)?!0:(t[a]=!t[a],l.checkNodeRelation(n,t),a=c(t,s.id.CHECK,n),l.setChkClass(n,a,t),l.repairParentChkClassWithSelf(n,t),n.treeObj.trigger(s.event.CHECK,[e,n.treeId,t]),!0)},n=function(e,t){if(t.chkDisabled===!0)return!1;var n=d.getSetting(e.data.treeId),a=c(t,s.id.CHECK,n);return t.check_Focus=!0,l.setChkClass(n,a,t),!0},a=function(e,t){if(t.chkDisabled===!0)return!1;var n=d.getSetting(e.data.treeId),a=c(t,s.id.CHECK,n);return t.check_Focus=!1,l.setChkClass(n,a,t),!0},e.extend(!0,e.fn.zTree.consts,o),e.extend(!0,e.fn.zTree._z,{tools:{},view:{checkNodeRelation:function(e,t){var n,a,o,i=e.data.key.children,r=e.data.key.checked;if(n=s.radio,e.check.chkStyle==n.STYLE){var p=d.getRadioCheckedList(e);if(t[r])if(e.check.radioType==n.TYPE_ALL){for(a=p.length-1;a>=0;a--)n=p[a],n[r]&&n!=t&&(n[r]=!1,p.splice(a,1),l.setChkClass(e,c(n,s.id.CHECK,e),n),n.parentTId!=t.parentTId&&l.repairParentChkClassWithSelf(e,n));p.push(t)}else for(p=t.parentTId?t.getParentNode():d.getRoot(e),a=0,o=p[i].length;o>a;a++)n=p[i][a],n[r]&&n!=t&&(n[r]=!1,l.setChkClass(e,c(n,s.id.CHECK,e),n));else if(e.check.radioType==n.TYPE_ALL)for(a=0,o=p.length;o>a;a++)if(t==p[a]){p.splice(a,1);break}}else t[r]&&(!t[i]||0==t[i].length||e.check.chkboxType.Y.indexOf("s")>-1)&&l.setSonNodeCheckBox(e,t,!0),!t[r]&&(!t[i]||0==t[i].length||e.check.chkboxType.N.indexOf("s")>-1)&&l.setSonNodeCheckBox(e,t,!1),t[r]&&e.check.chkboxType.Y.indexOf("p")>-1&&l.setParentNodeCheckBox(e,t,!0),!t[r]&&e.check.chkboxType.N.indexOf("p")>-1&&l.setParentNodeCheckBox(e,t,!1)},makeChkClass:function(e,t){var n=e.data.key.checked,a=s.checkbox,o=s.radio,i="",i=t.chkDisabled===!0?a.DISABLED:t.halfCheck?a.PART:e.check.chkStyle==o.STYLE?t.check_Child_State<1?a.FULL:a.PART:t[n]?2===t.check_Child_State||-1===t.check_Child_State?a.FULL:a.PART:t.check_Child_State<1?a.FULL:a.PART,n=e.check.chkStyle+"_"+(t[n]?a.TRUE:a.FALSE)+"_"+i,n=t.check_Focus&&t.chkDisabled!==!0?n+"_"+a.FOCUS:n;return s.className.BUTTON+" "+a.DEFAULT+" "+n},repairAllChk:function(e,t){if(e.check.enable&&e.check.chkStyle===s.checkbox.STYLE)for(var n=e.data.key.checked,a=e.data.key.children,o=d.getRoot(e),i=0,r=o[a].length;r>i;i++){var c=o[a][i];c.nocheck!==!0&&c.chkDisabled!==!0&&(c[n]=t),l.setSonNodeCheckBox(e,c,t)}},repairChkClass:function(e,t){if(t&&(d.makeChkFlag(e,t),t.nocheck!==!0)){var n=c(t,s.id.CHECK,e);l.setChkClass(e,n,t)}},repairParentChkClass:function(e,t){if(t&&t.parentTId){var n=t.getParentNode();l.repairChkClass(e,n),l.repairParentChkClass(e,n)}},repairParentChkClassWithSelf:function(e,t){if(t){var n=e.data.key.children;t[n]&&t[n].length>0?l.repairParentChkClass(e,t[n][0]):l.repairParentChkClass(e,t)}},repairSonChkDisabled:function(e,t,n,a){if(t){var o=e.data.key.children;if(t.chkDisabled!=n&&(t.chkDisabled=n),l.repairChkClass(e,t),t[o]&&a)for(var i=0,r=t[o].length;r>i;i++)l.repairSonChkDisabled(e,t[o][i],n,a)}},repairParentChkDisabled:function(e,t,n,a){t&&(t.chkDisabled!=n&&a&&(t.chkDisabled=n),l.repairChkClass(e,t),l.repairParentChkDisabled(e,t.getParentNode(),n,a))},setChkClass:function(e,t,n){t&&(n.nocheck===!0?t.hide():t.show(),t.removeClass(),t.addClass(l.makeChkClass(e,n)))},setParentNodeCheckBox:function(e,t,n,a){var o=e.data.key.children,i=e.data.key.checked,r=c(t,s.id.CHECK,e);if(a||(a=t),d.makeChkFlag(e,t),t.nocheck!==!0&&t.chkDisabled!==!0&&(t[i]=n,l.setChkClass(e,r,t),e.check.autoCheckTrigger&&t!=a&&e.treeObj.trigger(s.event.CHECK,[null,e.treeId,t])),t.parentTId){if(r=!0,!n)for(var o=t.getParentNode()[o],p=0,h=o.length;h>p;p++)if(o[p].nocheck!==!0&&o[p].chkDisabled!==!0&&o[p][i]||(o[p].nocheck===!0||o[p].chkDisabled===!0)&&o[p].check_Child_State>0){r=!1;break}r&&l.setParentNodeCheckBox(e,t.getParentNode(),n,a)}},setSonNodeCheckBox:function(e,t,n,a){if(t){var o=e.data.key.children,i=e.data.key.checked,r=c(t,s.id.CHECK,e);a||(a=t);var p=!1;if(t[o])for(var h=0,u=t[o].length;u>h&&t.chkDisabled!==!0;h++){var f=t[o][h];l.setSonNodeCheckBox(e,f,n,a),f.chkDisabled===!0&&(p=!0)}t!=d.getRoot(e)&&t.chkDisabled!==!0&&(p&&t.nocheck!==!0&&d.makeChkFlag(e,t),t.nocheck!==!0&&t.chkDisabled!==!0?(t[i]=n,p||(t.check_Child_State=t[o]&&t[o].length>0?n?2:0:-1)):t.check_Child_State=-1,l.setChkClass(e,r,t),e.check.autoCheckTrigger&&t!=a&&t.nocheck!==!0&&t.chkDisabled!==!0&&e.treeObj.trigger(s.event.CHECK,[null,e.treeId,t]))}}},event:{},data:{getRadioCheckedList:function(e){for(var t=d.getRoot(e).radioCheckedList,n=0,a=t.length;a>n;n++)d.getNodeCache(e,t[n].tId)||(t.splice(n,1),n--,a--);return t},getCheckStatus:function(e,t){if(!e.check.enable||t.nocheck||t.chkDisabled)return null;var n=e.data.key.checked;return{checked:t[n],half:t.halfCheck?t.halfCheck:e.check.chkStyle==s.radio.STYLE?2===t.check_Child_State:t[n]?t.check_Child_State>-1&&t.check_Child_State<2:t.check_Child_State>0}},getTreeCheckedNodes:function(e,t,n,a){if(!t)return[];for(var o=e.data.key.children,i=e.data.key.checked,r=n&&e.check.chkStyle==s.radio.STYLE&&e.check.radioType==s.radio.TYPE_ALL,a=a?a:[],l=0,c=t.length;c>l&&(t[l].nocheck===!0||t[l].chkDisabled===!0||t[l][i]!=n||(a.push(t[l]),!r))&&(d.getTreeCheckedNodes(e,t[l][o],n,a),!(r&&a.length>0));l++);return a},getTreeChangeCheckedNodes:function(e,t,n){if(!t)return[];for(var a=e.data.key.children,o=e.data.key.checked,n=n?n:[],i=0,r=t.length;r>i;i++)t[i].nocheck!==!0&&t[i].chkDisabled!==!0&&t[i][o]!=t[i].checkedOld&&n.push(t[i]),d.getTreeChangeCheckedNodes(e,t[i][a],n);return n},makeChkFlag:function(e,t){if(t){var n=e.data.key.children,a=e.data.key.checked,o=-1;if(t[n])for(var i=0,r=t[n].length;r>i;i++){var l=t[n][i],d=-1;if(e.check.chkStyle==s.radio.STYLE){if(d=l.nocheck===!0||l.chkDisabled===!0?l.check_Child_State:l.halfCheck===!0?2:l[a]?2:l.check_Child_State>0?2:0,2==d){o=2;break}0==d&&(o=0)}else if(e.check.chkStyle==s.checkbox.STYLE){if(d=l.nocheck===!0||l.chkDisabled===!0?l.check_Child_State:l.halfCheck===!0?1:l[a]?-1===l.check_Child_State||2===l.check_Child_State?2:1:l.check_Child_State>0?1:0,1===d){o=1;break}if(2===d&&o>-1&&i>0&&d!==o){o=1;break}if(2===o&&d>-1&&2>d){o=1;break}d>-1&&(o=d)}}t.check_Child_State=o}}}});var e=e.fn.zTree,r=e._z.tools,s=e.consts,l=e._z.view,d=e._z.data,c=r.$;d.exSetting(i),d.addInitBind(function(e){e.treeObj.bind(s.event.CHECK,function(t,n,a,o){t.srcEvent=n,r.apply(e.callback.onCheck,[t,a,o])})}),d.addInitUnBind(function(e){e.treeObj.unbind(s.event.CHECK)}),d.addInitCache(function(){}),d.addInitNode(function(e,t,n,a){n&&(t=e.data.key.checked,"string"==typeof n[t]&&(n[t]=r.eqs(n[t],"true")),n[t]=!!n[t],n.checkedOld=n[t],"string"==typeof n.nocheck&&(n.nocheck=r.eqs(n.nocheck,"true")),n.nocheck=!!n.nocheck||e.check.nocheckInherit&&a&&!!a.nocheck,"string"==typeof n.chkDisabled&&(n.chkDisabled=r.eqs(n.chkDisabled,"true")),n.chkDisabled=!!n.chkDisabled||e.check.chkDisabledInherit&&a&&!!a.chkDisabled,"string"==typeof n.halfCheck&&(n.halfCheck=r.eqs(n.halfCheck,"true")),n.halfCheck=!!n.halfCheck,n.check_Child_State=-1,n.check_Focus=!1,n.getCheckStatus=function(){return d.getCheckStatus(e,n)},e.check.chkStyle==s.radio.STYLE&&e.check.radioType==s.radio.TYPE_ALL&&n[t]&&d.getRoot(e).radioCheckedList.push(n))}),d.addInitProxy(function(e){var o=e.target,i=d.getSetting(e.data.treeId),l="",c=null,p="",h=null;if(r.eqs(e.type,"mouseover")?i.check.enable&&r.eqs(o.tagName,"span")&&null!==o.getAttribute("treeNode"+s.id.CHECK)&&(l=r.getNodeMainDom(o).id,p="mouseoverCheck"):r.eqs(e.type,"mouseout")?i.check.enable&&r.eqs(o.tagName,"span")&&null!==o.getAttribute("treeNode"+s.id.CHECK)&&(l=r.getNodeMainDom(o).id,p="mouseoutCheck"):r.eqs(e.type,"click")&&i.check.enable&&r.eqs(o.tagName,"span")&&null!==o.getAttribute("treeNode"+s.id.CHECK)&&(l=r.getNodeMainDom(o).id,p="checkNode"),l.length>0)switch(c=d.getNodeCache(i,l),p){case"checkNode":h=t;break;case"mouseoverCheck":h=n;break;case"mouseoutCheck":h=a}return{stop:"checkNode"===p,node:c,nodeEventType:p,nodeEventCallback:h,treeEventType:"",treeEventCallback:null}},!0),d.addInitRoot(function(e){d.getRoot(e).radioCheckedList=[]}),d.addBeforeA(function(e,t,n){e.check.enable&&(d.makeChkFlag(e,t),n.push("<span ID='",t.tId,s.id.CHECK,"' class='",l.makeChkClass(e,t),"' treeNode",s.id.CHECK,t.nocheck===!0?" style='display:none;'":"","></span>"))}),d.addZTreeTools(function(e,t){t.checkNode=function(e,t,n,a){var o=this.setting.data.key.checked;e.chkDisabled===!0||(t!==!0&&t!==!1&&(t=!e[o]),a=!!a,e[o]===t&&!n||a&&0==r.apply(this.setting.callback.beforeCheck,[this.setting.treeId,e],!0)||!r.uCanDo(this.setting)||!this.setting.check.enable||e.nocheck===!0)||(e[o]=t,t=c(e,s.id.CHECK,this.setting),(n||this.setting.check.chkStyle===s.radio.STYLE)&&l.checkNodeRelation(this.setting,e),l.setChkClass(this.setting,t,e),l.repairParentChkClassWithSelf(this.setting,e),a&&this.setting.treeObj.trigger(s.event.CHECK,[null,this.setting.treeId,e]))},t.checkAllNodes=function(e){l.repairAllChk(this.setting,!!e)},t.getCheckedNodes=function(e){var t=this.setting.data.key.children;return d.getTreeCheckedNodes(this.setting,d.getRoot(this.setting)[t],e!==!1)},t.getChangeCheckedNodes=function(){var e=this.setting.data.key.children;return d.getTreeChangeCheckedNodes(this.setting,d.getRoot(this.setting)[e])},t.setChkDisabled=function(e,t,n,a){t=!!t,n=!!n,l.repairSonChkDisabled(this.setting,e,t,!!a),l.repairParentChkDisabled(this.setting,e.getParentNode(),t,n)};var n=t.updateNode;t.updateNode=function(e,a){if(n&&n.apply(t,arguments),e&&this.setting.check.enable&&c(e,this.setting).get(0)&&r.uCanDo(this.setting)){var o=c(e,s.id.CHECK,this.setting);(1==a||this.setting.check.chkStyle===s.radio.STYLE)&&l.checkNodeRelation(this.setting,e),l.setChkClass(this.setting,o,e),l.repairParentChkClassWithSelf(this.setting,e)}}});var p=l.createNodes;l.createNodes=function(e,t,n,a){p&&p.apply(l,arguments),n&&l.repairParentChkClassWithSelf(e,a)};var h=l.removeNode;l.removeNode=function(e,t){var n=t.getParentNode();h&&h.apply(l,arguments),t&&n&&(l.repairChkClass(e,n),l.repairParentChkClass(e,n))};var u=l.appendNodes;l.appendNodes=function(e,t,n,a){var o="";return u&&(o=u.apply(l,arguments)),a&&d.makeChkFlag(e,a),o}}(jQuery);